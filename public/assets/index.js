class ge{constructor(e,t,n){this.eventTarget=e,this.eventName=t,this.eventOptions=n,this.unorderedBindings=new Set}connect(){this.eventTarget.addEventListener(this.eventName,this,this.eventOptions)}disconnect(){this.eventTarget.removeEventListener(this.eventName,this,this.eventOptions)}bindingConnected(e){this.unorderedBindings.add(e)}bindingDisconnected(e){this.unorderedBindings.delete(e)}handleEvent(e){const t=ve(e);for(const n of this.bindings){if(t.immediatePropagationStopped)break;n.handleEvent(t)}}hasBindings(){return this.unorderedBindings.size>0}get bindings(){return Array.from(this.unorderedBindings).sort((e,t)=>{const n=e.index,s=t.index;return n<s?-1:n>s?1:0})}}function ve(o){if("immediatePropagationStopped"in o)return o;{const{stopImmediatePropagation:e}=o;return Object.assign(o,{immediatePropagationStopped:!1,stopImmediatePropagation(){this.immediatePropagationStopped=!0,e.call(this)}})}}class ye{constructor(e){this.application=e,this.eventListenerMaps=new Map,this.started=!1}start(){this.started||(this.started=!0,this.eventListeners.forEach(e=>e.connect()))}stop(){this.started&&(this.started=!1,this.eventListeners.forEach(e=>e.disconnect()))}get eventListeners(){return Array.from(this.eventListenerMaps.values()).reduce((e,t)=>e.concat(Array.from(t.values())),[])}bindingConnected(e){this.fetchEventListenerForBinding(e).bindingConnected(e)}bindingDisconnected(e,t=!1){this.fetchEventListenerForBinding(e).bindingDisconnected(e),t&&this.clearEventListenersForBinding(e)}handleError(e,t,n={}){this.application.handleError(e,`Error ${t}`,n)}clearEventListenersForBinding(e){const t=this.fetchEventListenerForBinding(e);t.hasBindings()||(t.disconnect(),this.removeMappedEventListenerFor(e))}removeMappedEventListenerFor(e){const{eventTarget:t,eventName:n,eventOptions:s}=e,c=this.fetchEventListenerMapForEventTarget(t),h=this.cacheKey(n,s);c.delete(h),c.size==0&&this.eventListenerMaps.delete(t)}fetchEventListenerForBinding(e){const{eventTarget:t,eventName:n,eventOptions:s}=e;return this.fetchEventListener(t,n,s)}fetchEventListener(e,t,n){const s=this.fetchEventListenerMapForEventTarget(e),c=this.cacheKey(t,n);let h=s.get(c);return h||(h=this.createEventListener(e,t,n),s.set(c,h)),h}createEventListener(e,t,n){const s=new ge(e,t,n);return this.started&&s.connect(),s}fetchEventListenerMapForEventTarget(e){let t=this.eventListenerMaps.get(e);return t||(t=new Map,this.eventListenerMaps.set(e,t)),t}cacheKey(e,t){const n=[e];return Object.keys(t).sort().forEach(s=>{n.push(`${t[s]?"":"!"}${s}`)}),n.join(":")}}const be={stop({event:o,value:e}){return e&&o.stopPropagation(),!0},prevent({event:o,value:e}){return e&&o.preventDefault(),!0},self({event:o,value:e,element:t}){return e?t===o.target:!0}},Ae=/^(?:(?:([^.]+?)\+)?(.+?)(?:\.(.+?))?(?:@(window|document))?->)?(.+?)(?:#([^:]+?))(?::(.+))?$/;function we(o){const t=o.trim().match(Ae)||[];let n=t[2],s=t[3];return s&&!["keydown","keyup","keypress"].includes(n)&&(n+=`.${s}`,s=""),{eventTarget:Oe(t[4]),eventName:n,eventOptions:t[7]?Te(t[7]):{},identifier:t[5],methodName:t[6],keyFilter:t[1]||s}}function Oe(o){if(o=="window")return window;if(o=="document")return document}function Te(o){return o.split(":").reduce((e,t)=>Object.assign(e,{[t.replace(/^!/,"")]:!/^!/.test(t)}),{})}function Ee(o){if(o==window)return"window";if(o==document)return"document"}function G(o){return o.replace(/(?:[_-])([a-z0-9])/g,(e,t)=>t.toUpperCase())}function H(o){return G(o.replace(/--/g,"-").replace(/__/g,"_"))}function L(o){return o.charAt(0).toUpperCase()+o.slice(1)}function oe(o){return o.replace(/([A-Z])/g,(e,t)=>`-${t.toLowerCase()}`)}function ke(o){return o.match(/[^\s]+/g)||[]}function Y(o){return o!=null}function K(o,e){return Object.prototype.hasOwnProperty.call(o,e)}const Z=["meta","ctrl","alt","shift"];class xe{constructor(e,t,n,s){this.element=e,this.index=t,this.eventTarget=n.eventTarget||e,this.eventName=n.eventName||Me(e)||P("missing event name"),this.eventOptions=n.eventOptions||{},this.identifier=n.identifier||P("missing identifier"),this.methodName=n.methodName||P("missing method name"),this.keyFilter=n.keyFilter||"",this.schema=s}static forToken(e,t){return new this(e.element,e.index,we(e.content),t)}toString(){const e=this.keyFilter?`.${this.keyFilter}`:"",t=this.eventTargetName?`@${this.eventTargetName}`:"";return`${this.eventName}${e}${t}->${this.identifier}#${this.methodName}`}shouldIgnoreKeyboardEvent(e){if(!this.keyFilter)return!1;const t=this.keyFilter.split("+");if(this.keyFilterDissatisfied(e,t))return!0;const n=t.filter(s=>!Z.includes(s))[0];return n?(K(this.keyMappings,n)||P(`contains unknown key filter: ${this.keyFilter}`),this.keyMappings[n].toLowerCase()!==e.key.toLowerCase()):!1}shouldIgnoreMouseEvent(e){if(!this.keyFilter)return!1;const t=[this.keyFilter];return!!this.keyFilterDissatisfied(e,t)}get params(){const e={},t=new RegExp(`^data-${this.identifier}-(.+)-param$`,"i");for(const{name:n,value:s}of Array.from(this.element.attributes)){const c=n.match(t),h=c&&c[1];h&&(e[G(h)]=Se(s))}return e}get eventTargetName(){return Ee(this.eventTarget)}get keyMappings(){return this.schema.keyMappings}keyFilterDissatisfied(e,t){const[n,s,c,h]=Z.map(g=>t.includes(g));return e.metaKey!==n||e.ctrlKey!==s||e.altKey!==c||e.shiftKey!==h}}const Q={a:()=>"click",button:()=>"click",form:()=>"submit",details:()=>"toggle",input:o=>o.getAttribute("type")=="submit"?"click":"input",select:()=>"change",textarea:()=>"input"};function Me(o){const e=o.tagName.toLowerCase();if(e in Q)return Q[e](o)}function P(o){throw new Error(o)}function Se(o){try{return JSON.parse(o)}catch{return o}}class Fe{constructor(e,t){this.context=e,this.action=t}get index(){return this.action.index}get eventTarget(){return this.action.eventTarget}get eventOptions(){return this.action.eventOptions}get identifier(){return this.context.identifier}handleEvent(e){const t=this.prepareActionEvent(e);this.willBeInvokedByEvent(e)&&this.applyEventModifiers(t)&&this.invokeWithEvent(t)}get eventName(){return this.action.eventName}get method(){const e=this.controller[this.methodName];if(typeof e=="function")return e;throw new Error(`Action "${this.action}" references undefined method "${this.methodName}"`)}applyEventModifiers(e){const{element:t}=this.action,{actionDescriptorFilters:n}=this.context.application,{controller:s}=this.context;let c=!0;for(const[h,g]of Object.entries(this.eventOptions))if(h in n){const m=n[h];c=c&&m({name:h,value:g,event:e,element:t,controller:s})}else continue;return c}prepareActionEvent(e){return Object.assign(e,{params:this.action.params})}invokeWithEvent(e){const{target:t,currentTarget:n}=e;try{this.method.call(this.controller,e),this.context.logDebugActivity(this.methodName,{event:e,target:t,currentTarget:n,action:this.methodName})}catch(s){const{identifier:c,controller:h,element:g,index:m}=this,p={identifier:c,controller:h,element:g,index:m,event:e};this.context.handleError(s,`invoking action "${this.action}"`,p)}}willBeInvokedByEvent(e){const t=e.target;return e instanceof KeyboardEvent&&this.action.shouldIgnoreKeyboardEvent(e)||e instanceof MouseEvent&&this.action.shouldIgnoreMouseEvent(e)?!1:this.element===t?!0:t instanceof Element&&this.element.contains(t)?this.scope.containsElement(t):this.scope.containsElement(this.action.element)}get controller(){return this.context.controller}get methodName(){return this.action.methodName}get element(){return this.scope.element}get scope(){return this.context.scope}}class ae{constructor(e,t){this.mutationObserverInit={attributes:!0,childList:!0,subtree:!0},this.element=e,this.started=!1,this.delegate=t,this.elements=new Set,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,this.mutationObserverInit),this.refresh())}pause(e){this.started&&(this.mutationObserver.disconnect(),this.started=!1),e(),this.started||(this.mutationObserver.observe(this.element,this.mutationObserverInit),this.started=!0)}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started){const e=new Set(this.matchElementsInTree());for(const t of Array.from(this.elements))e.has(t)||this.removeElement(t);for(const t of Array.from(e))this.addElement(t)}}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){e.type=="attributes"?this.processAttributeChange(e.target,e.attributeName):e.type=="childList"&&(this.processRemovedNodes(e.removedNodes),this.processAddedNodes(e.addedNodes))}processAttributeChange(e,t){this.elements.has(e)?this.delegate.elementAttributeChanged&&this.matchElement(e)?this.delegate.elementAttributeChanged(e,t):this.removeElement(e):this.matchElement(e)&&this.addElement(e)}processRemovedNodes(e){for(const t of Array.from(e)){const n=this.elementFromNode(t);n&&this.processTree(n,this.removeElement)}}processAddedNodes(e){for(const t of Array.from(e)){const n=this.elementFromNode(t);n&&this.elementIsActive(n)&&this.processTree(n,this.addElement)}}matchElement(e){return this.delegate.matchElement(e)}matchElementsInTree(e=this.element){return this.delegate.matchElementsInTree(e)}processTree(e,t){for(const n of this.matchElementsInTree(e))t.call(this,n)}elementFromNode(e){if(e.nodeType==Node.ELEMENT_NODE)return e}elementIsActive(e){return e.isConnected!=this.element.isConnected?!1:this.element.contains(e)}addElement(e){this.elements.has(e)||this.elementIsActive(e)&&(this.elements.add(e),this.delegate.elementMatched&&this.delegate.elementMatched(e))}removeElement(e){this.elements.has(e)&&(this.elements.delete(e),this.delegate.elementUnmatched&&this.delegate.elementUnmatched(e))}}class le{constructor(e,t,n){this.attributeName=t,this.delegate=n,this.elementObserver=new ae(e,this)}get element(){return this.elementObserver.element}get selector(){return`[${this.attributeName}]`}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get started(){return this.elementObserver.started}matchElement(e){return e.hasAttribute(this.attributeName)}matchElementsInTree(e){const t=this.matchElement(e)?[e]:[],n=Array.from(e.querySelectorAll(this.selector));return t.concat(n)}elementMatched(e){this.delegate.elementMatchedAttribute&&this.delegate.elementMatchedAttribute(e,this.attributeName)}elementUnmatched(e){this.delegate.elementUnmatchedAttribute&&this.delegate.elementUnmatchedAttribute(e,this.attributeName)}elementAttributeChanged(e,t){this.delegate.elementAttributeValueChanged&&this.attributeName==t&&this.delegate.elementAttributeValueChanged(e,t)}}function Ne(o,e,t){ce(o,e).add(t)}function Ce(o,e,t){ce(o,e).delete(t),Ie(o,e)}function ce(o,e){let t=o.get(e);return t||(t=new Set,o.set(e,t)),t}function Ie(o,e){const t=o.get(e);t!=null&&t.size==0&&o.delete(e)}class x{constructor(){this.valuesByKey=new Map}get keys(){return Array.from(this.valuesByKey.keys())}get values(){return Array.from(this.valuesByKey.values()).reduce((t,n)=>t.concat(Array.from(n)),[])}get size(){return Array.from(this.valuesByKey.values()).reduce((t,n)=>t+n.size,0)}add(e,t){Ne(this.valuesByKey,e,t)}delete(e,t){Ce(this.valuesByKey,e,t)}has(e,t){const n=this.valuesByKey.get(e);return n!=null&&n.has(t)}hasKey(e){return this.valuesByKey.has(e)}hasValue(e){return Array.from(this.valuesByKey.values()).some(n=>n.has(e))}getValuesForKey(e){const t=this.valuesByKey.get(e);return t?Array.from(t):[]}getKeysForValue(e){return Array.from(this.valuesByKey).filter(([t,n])=>n.has(e)).map(([t,n])=>t)}}class Le{constructor(e,t,n,s){this._selector=t,this.details=s,this.elementObserver=new ae(e,this),this.delegate=n,this.matchesByElement=new x}get started(){return this.elementObserver.started}get selector(){return this._selector}set selector(e){this._selector=e,this.refresh()}start(){this.elementObserver.start()}pause(e){this.elementObserver.pause(e)}stop(){this.elementObserver.stop()}refresh(){this.elementObserver.refresh()}get element(){return this.elementObserver.element}matchElement(e){const{selector:t}=this;if(t){const n=e.matches(t);return this.delegate.selectorMatchElement?n&&this.delegate.selectorMatchElement(e,this.details):n}else return!1}matchElementsInTree(e){const{selector:t}=this;if(t){const n=this.matchElement(e)?[e]:[],s=Array.from(e.querySelectorAll(t)).filter(c=>this.matchElement(c));return n.concat(s)}else return[]}elementMatched(e){const{selector:t}=this;t&&this.selectorMatched(e,t)}elementUnmatched(e){const t=this.matchesByElement.getKeysForValue(e);for(const n of t)this.selectorUnmatched(e,n)}elementAttributeChanged(e,t){const{selector:n}=this;if(n){const s=this.matchElement(e),c=this.matchesByElement.has(n,e);s&&!c?this.selectorMatched(e,n):!s&&c&&this.selectorUnmatched(e,n)}}selectorMatched(e,t){this.delegate.selectorMatched(e,t,this.details),this.matchesByElement.add(t,e)}selectorUnmatched(e,t){this.delegate.selectorUnmatched(e,t,this.details),this.matchesByElement.delete(t,e)}}class Be{constructor(e,t){this.element=e,this.delegate=t,this.started=!1,this.stringMap=new Map,this.mutationObserver=new MutationObserver(n=>this.processMutations(n))}start(){this.started||(this.started=!0,this.mutationObserver.observe(this.element,{attributes:!0,attributeOldValue:!0}),this.refresh())}stop(){this.started&&(this.mutationObserver.takeRecords(),this.mutationObserver.disconnect(),this.started=!1)}refresh(){if(this.started)for(const e of this.knownAttributeNames)this.refreshAttribute(e,null)}processMutations(e){if(this.started)for(const t of e)this.processMutation(t)}processMutation(e){const t=e.attributeName;t&&this.refreshAttribute(t,e.oldValue)}refreshAttribute(e,t){const n=this.delegate.getStringMapKeyForAttribute(e);if(n!=null){this.stringMap.has(e)||this.stringMapKeyAdded(n,e);const s=this.element.getAttribute(e);if(this.stringMap.get(e)!=s&&this.stringMapValueChanged(s,n,t),s==null){const c=this.stringMap.get(e);this.stringMap.delete(e),c&&this.stringMapKeyRemoved(n,e,c)}else this.stringMap.set(e,s)}}stringMapKeyAdded(e,t){this.delegate.stringMapKeyAdded&&this.delegate.stringMapKeyAdded(e,t)}stringMapValueChanged(e,t,n){this.delegate.stringMapValueChanged&&this.delegate.stringMapValueChanged(e,t,n)}stringMapKeyRemoved(e,t,n){this.delegate.stringMapKeyRemoved&&this.delegate.stringMapKeyRemoved(e,t,n)}get knownAttributeNames(){return Array.from(new Set(this.currentAttributeNames.concat(this.recordedAttributeNames)))}get currentAttributeNames(){return Array.from(this.element.attributes).map(e=>e.name)}get recordedAttributeNames(){return Array.from(this.stringMap.keys())}}class ue{constructor(e,t,n){this.attributeObserver=new le(e,t,this),this.delegate=n,this.tokensByElement=new x}get started(){return this.attributeObserver.started}start(){this.attributeObserver.start()}pause(e){this.attributeObserver.pause(e)}stop(){this.attributeObserver.stop()}refresh(){this.attributeObserver.refresh()}get element(){return this.attributeObserver.element}get attributeName(){return this.attributeObserver.attributeName}elementMatchedAttribute(e){this.tokensMatched(this.readTokensForElement(e))}elementAttributeValueChanged(e){const[t,n]=this.refreshTokensForElement(e);this.tokensUnmatched(t),this.tokensMatched(n)}elementUnmatchedAttribute(e){this.tokensUnmatched(this.tokensByElement.getValuesForKey(e))}tokensMatched(e){e.forEach(t=>this.tokenMatched(t))}tokensUnmatched(e){e.forEach(t=>this.tokenUnmatched(t))}tokenMatched(e){this.delegate.tokenMatched(e),this.tokensByElement.add(e.element,e)}tokenUnmatched(e){this.delegate.tokenUnmatched(e),this.tokensByElement.delete(e.element,e)}refreshTokensForElement(e){const t=this.tokensByElement.getValuesForKey(e),n=this.readTokensForElement(e),s=De(t,n).findIndex(([c,h])=>!$e(c,h));return s==-1?[[],[]]:[t.slice(s),n.slice(s)]}readTokensForElement(e){const t=this.attributeName,n=e.getAttribute(t)||"";return Pe(n,e,t)}}function Pe(o,e,t){return o.trim().split(/\s+/).filter(n=>n.length).map((n,s)=>({element:e,attributeName:t,content:n,index:s}))}function De(o,e){const t=Math.max(o.length,e.length);return Array.from({length:t},(n,s)=>[o[s],e[s]])}function $e(o,e){return o&&e&&o.index==e.index&&o.content==e.content}class de{constructor(e,t,n){this.tokenListObserver=new ue(e,t,this),this.delegate=n,this.parseResultsByToken=new WeakMap,this.valuesByTokenByElement=new WeakMap}get started(){return this.tokenListObserver.started}start(){this.tokenListObserver.start()}stop(){this.tokenListObserver.stop()}refresh(){this.tokenListObserver.refresh()}get element(){return this.tokenListObserver.element}get attributeName(){return this.tokenListObserver.attributeName}tokenMatched(e){const{element:t}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(t).set(e,n),this.delegate.elementMatchedValue(t,n))}tokenUnmatched(e){const{element:t}=e,{value:n}=this.fetchParseResultForToken(e);n&&(this.fetchValuesByTokenForElement(t).delete(e),this.delegate.elementUnmatchedValue(t,n))}fetchParseResultForToken(e){let t=this.parseResultsByToken.get(e);return t||(t=this.parseToken(e),this.parseResultsByToken.set(e,t)),t}fetchValuesByTokenForElement(e){let t=this.valuesByTokenByElement.get(e);return t||(t=new Map,this.valuesByTokenByElement.set(e,t)),t}parseToken(e){try{return{value:this.delegate.parseValueForToken(e)}}catch(t){return{error:t}}}}class Ve{constructor(e,t){this.context=e,this.delegate=t,this.bindingsByAction=new Map}start(){this.valueListObserver||(this.valueListObserver=new de(this.element,this.actionAttribute,this),this.valueListObserver.start())}stop(){this.valueListObserver&&(this.valueListObserver.stop(),delete this.valueListObserver,this.disconnectAllActions())}get element(){return this.context.element}get identifier(){return this.context.identifier}get actionAttribute(){return this.schema.actionAttribute}get schema(){return this.context.schema}get bindings(){return Array.from(this.bindingsByAction.values())}connectAction(e){const t=new Fe(this.context,e);this.bindingsByAction.set(e,t),this.delegate.bindingConnected(t)}disconnectAction(e){const t=this.bindingsByAction.get(e);t&&(this.bindingsByAction.delete(e),this.delegate.bindingDisconnected(t))}disconnectAllActions(){this.bindings.forEach(e=>this.delegate.bindingDisconnected(e,!0)),this.bindingsByAction.clear()}parseValueForToken(e){const t=xe.forToken(e,this.schema);if(t.identifier==this.identifier)return t}elementMatchedValue(e,t){this.connectAction(t)}elementUnmatchedValue(e,t){this.disconnectAction(t)}}class je{constructor(e,t){this.context=e,this.receiver=t,this.stringMapObserver=new Be(this.element,this),this.valueDescriptorMap=this.controller.valueDescriptorMap}start(){this.stringMapObserver.start(),this.invokeChangedCallbacksForDefaultValues()}stop(){this.stringMapObserver.stop()}get element(){return this.context.element}get controller(){return this.context.controller}getStringMapKeyForAttribute(e){if(e in this.valueDescriptorMap)return this.valueDescriptorMap[e].name}stringMapKeyAdded(e,t){const n=this.valueDescriptorMap[t];this.hasValue(e)||this.invokeChangedCallback(e,n.writer(this.receiver[e]),n.writer(n.defaultValue))}stringMapValueChanged(e,t,n){const s=this.valueDescriptorNameMap[t];e!==null&&(n===null&&(n=s.writer(s.defaultValue)),this.invokeChangedCallback(t,e,n))}stringMapKeyRemoved(e,t,n){const s=this.valueDescriptorNameMap[e];this.hasValue(e)?this.invokeChangedCallback(e,s.writer(this.receiver[e]),n):this.invokeChangedCallback(e,s.writer(s.defaultValue),n)}invokeChangedCallbacksForDefaultValues(){for(const{key:e,name:t,defaultValue:n,writer:s}of this.valueDescriptors)n!=null&&!this.controller.data.has(e)&&this.invokeChangedCallback(t,s(n),void 0)}invokeChangedCallback(e,t,n){const s=`${e}Changed`,c=this.receiver[s];if(typeof c=="function"){const h=this.valueDescriptorNameMap[e];try{const g=h.reader(t);let m=n;n&&(m=h.reader(n)),c.call(this.receiver,g,m)}catch(g){throw g instanceof TypeError&&(g.message=`Stimulus Value "${this.context.identifier}.${h.name}" - ${g.message}`),g}}}get valueDescriptors(){const{valueDescriptorMap:e}=this;return Object.keys(e).map(t=>e[t])}get valueDescriptorNameMap(){const e={};return Object.keys(this.valueDescriptorMap).forEach(t=>{const n=this.valueDescriptorMap[t];e[n.name]=n}),e}hasValue(e){const t=this.valueDescriptorNameMap[e],n=`has${L(t.name)}`;return this.receiver[n]}}class He{constructor(e,t){this.context=e,this.delegate=t,this.targetsByName=new x}start(){this.tokenListObserver||(this.tokenListObserver=new ue(this.element,this.attributeName,this),this.tokenListObserver.start())}stop(){this.tokenListObserver&&(this.disconnectAllTargets(),this.tokenListObserver.stop(),delete this.tokenListObserver)}tokenMatched({element:e,content:t}){this.scope.containsElement(e)&&this.connectTarget(e,t)}tokenUnmatched({element:e,content:t}){this.disconnectTarget(e,t)}connectTarget(e,t){var n;this.targetsByName.has(t,e)||(this.targetsByName.add(t,e),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetConnected(e,t)))}disconnectTarget(e,t){var n;this.targetsByName.has(t,e)&&(this.targetsByName.delete(t,e),(n=this.tokenListObserver)===null||n===void 0||n.pause(()=>this.delegate.targetDisconnected(e,t)))}disconnectAllTargets(){for(const e of this.targetsByName.keys)for(const t of this.targetsByName.getValuesForKey(e))this.disconnectTarget(t,e)}get attributeName(){return`data-${this.context.identifier}-target`}get element(){return this.context.element}get scope(){return this.context.scope}}function B(o,e){const t=fe(o);return Array.from(t.reduce((n,s)=>(Re(s,e).forEach(c=>n.add(c)),n),new Set))}function Ke(o,e){return fe(o).reduce((n,s)=>(n.push(...Ge(s,e)),n),[])}function fe(o){const e=[];for(;o;)e.push(o),o=Object.getPrototypeOf(o);return e.reverse()}function Re(o,e){const t=o[e];return Array.isArray(t)?t:[]}function Ge(o,e){const t=o[e];return t?Object.keys(t).map(n=>[n,t[n]]):[]}class Ue{constructor(e,t){this.started=!1,this.context=e,this.delegate=t,this.outletsByName=new x,this.outletElementsByName=new x,this.selectorObserverMap=new Map,this.attributeObserverMap=new Map}start(){this.started||(this.outletDefinitions.forEach(e=>{this.setupSelectorObserverForOutlet(e),this.setupAttributeObserverForOutlet(e)}),this.started=!0,this.dependentContexts.forEach(e=>e.refresh()))}refresh(){this.selectorObserverMap.forEach(e=>e.refresh()),this.attributeObserverMap.forEach(e=>e.refresh())}stop(){this.started&&(this.started=!1,this.disconnectAllOutlets(),this.stopSelectorObservers(),this.stopAttributeObservers())}stopSelectorObservers(){this.selectorObserverMap.size>0&&(this.selectorObserverMap.forEach(e=>e.stop()),this.selectorObserverMap.clear())}stopAttributeObservers(){this.attributeObserverMap.size>0&&(this.attributeObserverMap.forEach(e=>e.stop()),this.attributeObserverMap.clear())}selectorMatched(e,t,{outletName:n}){const s=this.getOutlet(e,n);s&&this.connectOutlet(s,e,n)}selectorUnmatched(e,t,{outletName:n}){const s=this.getOutletFromMap(e,n);s&&this.disconnectOutlet(s,e,n)}selectorMatchElement(e,{outletName:t}){const n=this.selector(t),s=this.hasOutlet(e,t),c=e.matches(`[${this.schema.controllerAttribute}~=${t}]`);return n?s&&c&&e.matches(n):!1}elementMatchedAttribute(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}elementAttributeValueChanged(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}elementUnmatchedAttribute(e,t){const n=this.getOutletNameFromOutletAttributeName(t);n&&this.updateSelectorObserverForOutlet(n)}connectOutlet(e,t,n){var s;this.outletElementsByName.has(n,t)||(this.outletsByName.add(n,e),this.outletElementsByName.add(n,t),(s=this.selectorObserverMap.get(n))===null||s===void 0||s.pause(()=>this.delegate.outletConnected(e,t,n)))}disconnectOutlet(e,t,n){var s;this.outletElementsByName.has(n,t)&&(this.outletsByName.delete(n,e),this.outletElementsByName.delete(n,t),(s=this.selectorObserverMap.get(n))===null||s===void 0||s.pause(()=>this.delegate.outletDisconnected(e,t,n)))}disconnectAllOutlets(){for(const e of this.outletElementsByName.keys)for(const t of this.outletElementsByName.getValuesForKey(e))for(const n of this.outletsByName.getValuesForKey(e))this.disconnectOutlet(n,t,e)}updateSelectorObserverForOutlet(e){const t=this.selectorObserverMap.get(e);t&&(t.selector=this.selector(e))}setupSelectorObserverForOutlet(e){const t=this.selector(e),n=new Le(document.body,t,this,{outletName:e});this.selectorObserverMap.set(e,n),n.start()}setupAttributeObserverForOutlet(e){const t=this.attributeNameForOutletName(e),n=new le(this.scope.element,t,this);this.attributeObserverMap.set(e,n),n.start()}selector(e){return this.scope.outlets.getSelectorForOutletName(e)}attributeNameForOutletName(e){return this.scope.schema.outletAttributeForScope(this.identifier,e)}getOutletNameFromOutletAttributeName(e){return this.outletDefinitions.find(t=>this.attributeNameForOutletName(t)===e)}get outletDependencies(){const e=new x;return this.router.modules.forEach(t=>{const n=t.definition.controllerConstructor;B(n,"outlets").forEach(c=>e.add(c,t.identifier))}),e}get outletDefinitions(){return this.outletDependencies.getKeysForValue(this.identifier)}get dependentControllerIdentifiers(){return this.outletDependencies.getValuesForKey(this.identifier)}get dependentContexts(){const e=this.dependentControllerIdentifiers;return this.router.contexts.filter(t=>e.includes(t.identifier))}hasOutlet(e,t){return!!this.getOutlet(e,t)||!!this.getOutletFromMap(e,t)}getOutlet(e,t){return this.application.getControllerForElementAndIdentifier(e,t)}getOutletFromMap(e,t){return this.outletsByName.getValuesForKey(t).find(n=>n.element===e)}get scope(){return this.context.scope}get schema(){return this.context.schema}get identifier(){return this.context.identifier}get application(){return this.context.application}get router(){return this.application.router}}class qe{constructor(e,t){this.logDebugActivity=(n,s={})=>{const{identifier:c,controller:h,element:g}=this;s=Object.assign({identifier:c,controller:h,element:g},s),this.application.logDebugActivity(this.identifier,n,s)},this.module=e,this.scope=t,this.controller=new e.controllerConstructor(this),this.bindingObserver=new Ve(this,this.dispatcher),this.valueObserver=new je(this,this.controller),this.targetObserver=new He(this,this),this.outletObserver=new Ue(this,this);try{this.controller.initialize(),this.logDebugActivity("initialize")}catch(n){this.handleError(n,"initializing controller")}}connect(){this.bindingObserver.start(),this.valueObserver.start(),this.targetObserver.start(),this.outletObserver.start();try{this.controller.connect(),this.logDebugActivity("connect")}catch(e){this.handleError(e,"connecting controller")}}refresh(){this.outletObserver.refresh()}disconnect(){try{this.controller.disconnect(),this.logDebugActivity("disconnect")}catch(e){this.handleError(e,"disconnecting controller")}this.outletObserver.stop(),this.targetObserver.stop(),this.valueObserver.stop(),this.bindingObserver.stop()}get application(){return this.module.application}get identifier(){return this.module.identifier}get schema(){return this.application.schema}get dispatcher(){return this.application.dispatcher}get element(){return this.scope.element}get parentElement(){return this.element.parentElement}handleError(e,t,n={}){const{identifier:s,controller:c,element:h}=this;n=Object.assign({identifier:s,controller:c,element:h},n),this.application.handleError(e,`Error ${t}`,n)}targetConnected(e,t){this.invokeControllerMethod(`${t}TargetConnected`,e)}targetDisconnected(e,t){this.invokeControllerMethod(`${t}TargetDisconnected`,e)}outletConnected(e,t,n){this.invokeControllerMethod(`${H(n)}OutletConnected`,e,t)}outletDisconnected(e,t,n){this.invokeControllerMethod(`${H(n)}OutletDisconnected`,e,t)}invokeControllerMethod(e,...t){const n=this.controller;typeof n[e]=="function"&&n[e](...t)}}function Xe(o){return We(o,Ye(o))}function We(o,e){const t=ze(o),n=Ze(o.prototype,e);return Object.defineProperties(t.prototype,n),t}function Ye(o){return B(o,"blessings").reduce((t,n)=>{const s=n(o);for(const c in s){const h=t[c]||{};t[c]=Object.assign(h,s[c])}return t},{})}function Ze(o,e){return Je(e).reduce((t,n)=>{const s=Qe(o,e,n);return s&&Object.assign(t,{[n]:s}),t},{})}function Qe(o,e,t){const n=Object.getOwnPropertyDescriptor(o,t);if(!(n&&"value"in n)){const c=Object.getOwnPropertyDescriptor(e,t).value;return n&&(c.get=n.get||c.get,c.set=n.set||c.set),c}}const Je=typeof Object.getOwnPropertySymbols=="function"?o=>[...Object.getOwnPropertyNames(o),...Object.getOwnPropertySymbols(o)]:Object.getOwnPropertyNames,ze=(()=>{function o(t){function n(){return Reflect.construct(t,arguments,new.target)}return n.prototype=Object.create(t.prototype,{constructor:{value:n}}),Reflect.setPrototypeOf(n,t),n}function e(){const n=o(function(){this.a.call(this)});return n.prototype.a=function(){},new n}try{return e(),o}catch{return n=>class extends n{}}})();function et(o){return{identifier:o.identifier,controllerConstructor:Xe(o.controllerConstructor)}}class tt{constructor(e,t){this.application=e,this.definition=et(t),this.contextsByScope=new WeakMap,this.connectedContexts=new Set}get identifier(){return this.definition.identifier}get controllerConstructor(){return this.definition.controllerConstructor}get contexts(){return Array.from(this.connectedContexts)}connectContextForScope(e){const t=this.fetchContextForScope(e);this.connectedContexts.add(t),t.connect()}disconnectContextForScope(e){const t=this.contextsByScope.get(e);t&&(this.connectedContexts.delete(t),t.disconnect())}fetchContextForScope(e){let t=this.contextsByScope.get(e);return t||(t=new qe(this,e),this.contextsByScope.set(e,t)),t}}class rt{constructor(e){this.scope=e}has(e){return this.data.has(this.getDataKey(e))}get(e){return this.getAll(e)[0]}getAll(e){const t=this.data.get(this.getDataKey(e))||"";return ke(t)}getAttributeName(e){return this.data.getAttributeNameForKey(this.getDataKey(e))}getDataKey(e){return`${e}-class`}get data(){return this.scope.data}}class nt{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get(e){const t=this.getAttributeNameForKey(e);return this.element.getAttribute(t)}set(e,t){const n=this.getAttributeNameForKey(e);return this.element.setAttribute(n,t),this.get(e)}has(e){const t=this.getAttributeNameForKey(e);return this.element.hasAttribute(t)}delete(e){if(this.has(e)){const t=this.getAttributeNameForKey(e);return this.element.removeAttribute(t),!0}else return!1}getAttributeNameForKey(e){return`data-${this.identifier}-${oe(e)}`}}class it{constructor(e){this.warnedKeysByObject=new WeakMap,this.logger=e}warn(e,t,n){let s=this.warnedKeysByObject.get(e);s||(s=new Set,this.warnedKeysByObject.set(e,s)),s.has(t)||(s.add(t),this.logger.warn(n,e))}}function R(o,e){return`[${o}~="${e}"]`}class st{constructor(e){this.scope=e}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,n)=>t||this.findTarget(n)||this.findLegacyTarget(n),void 0)}findAll(...e){return e.reduce((t,n)=>[...t,...this.findAllTargets(n),...this.findAllLegacyTargets(n)],[])}findTarget(e){const t=this.getSelectorForTargetName(e);return this.scope.findElement(t)}findAllTargets(e){const t=this.getSelectorForTargetName(e);return this.scope.findAllElements(t)}getSelectorForTargetName(e){const t=this.schema.targetAttributeForScope(this.identifier);return R(t,e)}findLegacyTarget(e){const t=this.getLegacySelectorForTargetName(e);return this.deprecate(this.scope.findElement(t),e)}findAllLegacyTargets(e){const t=this.getLegacySelectorForTargetName(e);return this.scope.findAllElements(t).map(n=>this.deprecate(n,e))}getLegacySelectorForTargetName(e){const t=`${this.identifier}.${e}`;return R(this.schema.targetAttribute,t)}deprecate(e,t){if(e){const{identifier:n}=this,s=this.schema.targetAttribute,c=this.schema.targetAttributeForScope(n);this.guide.warn(e,`target:${t}`,`Please replace ${s}="${n}.${t}" with ${c}="${t}". The ${s} attribute is deprecated and will be removed in a future version of Stimulus.`)}return e}get guide(){return this.scope.guide}}class ot{constructor(e,t){this.scope=e,this.controllerElement=t}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get schema(){return this.scope.schema}has(e){return this.find(e)!=null}find(...e){return e.reduce((t,n)=>t||this.findOutlet(n),void 0)}findAll(...e){return e.reduce((t,n)=>[...t,...this.findAllOutlets(n)],[])}getSelectorForOutletName(e){const t=this.schema.outletAttributeForScope(this.identifier,e);return this.controllerElement.getAttribute(t)}findOutlet(e){const t=this.getSelectorForOutletName(e);if(t)return this.findElement(t,e)}findAllOutlets(e){const t=this.getSelectorForOutletName(e);return t?this.findAllElements(t,e):[]}findElement(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))[0]}findAllElements(e,t){return this.scope.queryElements(e).filter(s=>this.matchesElement(s,e,t))}matchesElement(e,t,n){const s=e.getAttribute(this.scope.schema.controllerAttribute)||"";return e.matches(t)&&s.split(" ").includes(n)}}class U{constructor(e,t,n,s){this.targets=new st(this),this.classes=new rt(this),this.data=new nt(this),this.containsElement=c=>c.closest(this.controllerSelector)===this.element,this.schema=e,this.element=t,this.identifier=n,this.guide=new it(s),this.outlets=new ot(this.documentScope,t)}findElement(e){return this.element.matches(e)?this.element:this.queryElements(e).find(this.containsElement)}findAllElements(e){return[...this.element.matches(e)?[this.element]:[],...this.queryElements(e).filter(this.containsElement)]}queryElements(e){return Array.from(this.element.querySelectorAll(e))}get controllerSelector(){return R(this.schema.controllerAttribute,this.identifier)}get isDocumentScope(){return this.element===document.documentElement}get documentScope(){return this.isDocumentScope?this:new U(this.schema,document.documentElement,this.identifier,this.guide.logger)}}class at{constructor(e,t,n){this.element=e,this.schema=t,this.delegate=n,this.valueListObserver=new de(this.element,this.controllerAttribute,this),this.scopesByIdentifierByElement=new WeakMap,this.scopeReferenceCounts=new WeakMap}start(){this.valueListObserver.start()}stop(){this.valueListObserver.stop()}get controllerAttribute(){return this.schema.controllerAttribute}parseValueForToken(e){const{element:t,content:n}=e;return this.parseValueForElementAndIdentifier(t,n)}parseValueForElementAndIdentifier(e,t){const n=this.fetchScopesByIdentifierForElement(e);let s=n.get(t);return s||(s=this.delegate.createScopeForElementAndIdentifier(e,t),n.set(t,s)),s}elementMatchedValue(e,t){const n=(this.scopeReferenceCounts.get(t)||0)+1;this.scopeReferenceCounts.set(t,n),n==1&&this.delegate.scopeConnected(t)}elementUnmatchedValue(e,t){const n=this.scopeReferenceCounts.get(t);n&&(this.scopeReferenceCounts.set(t,n-1),n==1&&this.delegate.scopeDisconnected(t))}fetchScopesByIdentifierForElement(e){let t=this.scopesByIdentifierByElement.get(e);return t||(t=new Map,this.scopesByIdentifierByElement.set(e,t)),t}}class lt{constructor(e){this.application=e,this.scopeObserver=new at(this.element,this.schema,this),this.scopesByIdentifier=new x,this.modulesByIdentifier=new Map}get element(){return this.application.element}get schema(){return this.application.schema}get logger(){return this.application.logger}get controllerAttribute(){return this.schema.controllerAttribute}get modules(){return Array.from(this.modulesByIdentifier.values())}get contexts(){return this.modules.reduce((e,t)=>e.concat(t.contexts),[])}start(){this.scopeObserver.start()}stop(){this.scopeObserver.stop()}loadDefinition(e){this.unloadIdentifier(e.identifier);const t=new tt(this.application,e);this.connectModule(t);const n=e.controllerConstructor.afterLoad;n&&n.call(e.controllerConstructor,e.identifier,this.application)}unloadIdentifier(e){const t=this.modulesByIdentifier.get(e);t&&this.disconnectModule(t)}getContextForElementAndIdentifier(e,t){const n=this.modulesByIdentifier.get(t);if(n)return n.contexts.find(s=>s.element==e)}proposeToConnectScopeForElementAndIdentifier(e,t){const n=this.scopeObserver.parseValueForElementAndIdentifier(e,t);n?this.scopeObserver.elementMatchedValue(n.element,n):console.error(`Couldn't find or create scope for identifier: "${t}" and element:`,e)}handleError(e,t,n){this.application.handleError(e,t,n)}createScopeForElementAndIdentifier(e,t){return new U(this.schema,e,t,this.logger)}scopeConnected(e){this.scopesByIdentifier.add(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.connectContextForScope(e)}scopeDisconnected(e){this.scopesByIdentifier.delete(e.identifier,e);const t=this.modulesByIdentifier.get(e.identifier);t&&t.disconnectContextForScope(e)}connectModule(e){this.modulesByIdentifier.set(e.identifier,e),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(n=>e.connectContextForScope(n))}disconnectModule(e){this.modulesByIdentifier.delete(e.identifier),this.scopesByIdentifier.getValuesForKey(e.identifier).forEach(n=>e.disconnectContextForScope(n))}}const ct={controllerAttribute:"data-controller",actionAttribute:"data-action",targetAttribute:"data-target",targetAttributeForScope:o=>`data-${o}-target`,outletAttributeForScope:(o,e)=>`data-${o}-${e}-outlet`,keyMappings:Object.assign(Object.assign({enter:"Enter",tab:"Tab",esc:"Escape",space:" ",up:"ArrowUp",down:"ArrowDown",left:"ArrowLeft",right:"ArrowRight",home:"Home",end:"End",page_up:"PageUp",page_down:"PageDown"},J("abcdefghijklmnopqrstuvwxyz".split("").map(o=>[o,o]))),J("0123456789".split("").map(o=>[o,o])))};function J(o){return o.reduce((e,[t,n])=>Object.assign(Object.assign({},e),{[t]:n}),{})}class ut{constructor(e=document.documentElement,t=ct){this.logger=console,this.debug=!1,this.logDebugActivity=(n,s,c={})=>{this.debug&&this.logFormattedMessage(n,s,c)},this.element=e,this.schema=t,this.dispatcher=new ye(this),this.router=new lt(this),this.actionDescriptorFilters=Object.assign({},be)}static start(e,t){const n=new this(e,t);return n.start(),n}async start(){await dt(),this.logDebugActivity("application","starting"),this.dispatcher.start(),this.router.start(),this.logDebugActivity("application","start")}stop(){this.logDebugActivity("application","stopping"),this.dispatcher.stop(),this.router.stop(),this.logDebugActivity("application","stop")}register(e,t){this.load({identifier:e,controllerConstructor:t})}registerActionOption(e,t){this.actionDescriptorFilters[e]=t}load(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>{s.controllerConstructor.shouldLoad&&this.router.loadDefinition(s)})}unload(e,...t){(Array.isArray(e)?e:[e,...t]).forEach(s=>this.router.unloadIdentifier(s))}get controllers(){return this.router.contexts.map(e=>e.controller)}getControllerForElementAndIdentifier(e,t){const n=this.router.getContextForElementAndIdentifier(e,t);return n?n.controller:null}handleError(e,t,n){var s;this.logger.error(`%s

%o

%o`,t,e,n),(s=window.onerror)===null||s===void 0||s.call(window,t,"",0,0,e)}logFormattedMessage(e,t,n={}){n=Object.assign({application:this},n),this.logger.groupCollapsed(`${e} #${t}`),this.logger.log("details:",Object.assign({},n)),this.logger.groupEnd()}}function dt(){return new Promise(o=>{document.readyState=="loading"?document.addEventListener("DOMContentLoaded",()=>o()):o()})}function ft(o){return B(o,"classes").reduce((t,n)=>Object.assign(t,ht(n)),{})}function ht(o){return{[`${o}Class`]:{get(){const{classes:e}=this;if(e.has(o))return e.get(o);{const t=e.getAttributeName(o);throw new Error(`Missing attribute "${t}"`)}}},[`${o}Classes`]:{get(){return this.classes.getAll(o)}},[`has${L(o)}Class`]:{get(){return this.classes.has(o)}}}}function pt(o){return B(o,"outlets").reduce((t,n)=>Object.assign(t,mt(n)),{})}function z(o,e,t){return o.application.getControllerForElementAndIdentifier(e,t)}function ee(o,e,t){let n=z(o,e,t);if(n||(o.application.router.proposeToConnectScopeForElementAndIdentifier(e,t),n=z(o,e,t),n))return n}function mt(o){const e=H(o);return{[`${e}Outlet`]:{get(){const t=this.outlets.find(o),n=this.outlets.getSelectorForOutletName(o);if(t){const s=ee(this,t,o);if(s)return s;throw new Error(`The provided outlet element is missing an outlet controller "${o}" instance for host controller "${this.identifier}"`)}throw new Error(`Missing outlet element "${o}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}Outlets`]:{get(){const t=this.outlets.findAll(o);return t.length>0?t.map(n=>{const s=ee(this,n,o);if(s)return s;console.warn(`The provided outlet element is missing an outlet controller "${o}" instance for host controller "${this.identifier}"`,n)}).filter(n=>n):[]}},[`${e}OutletElement`]:{get(){const t=this.outlets.find(o),n=this.outlets.getSelectorForOutletName(o);if(t)return t;throw new Error(`Missing outlet element "${o}" for host controller "${this.identifier}". Stimulus couldn't find a matching outlet element using selector "${n}".`)}},[`${e}OutletElements`]:{get(){return this.outlets.findAll(o)}},[`has${L(e)}Outlet`]:{get(){return this.outlets.has(o)}}}}function _t(o){return B(o,"targets").reduce((t,n)=>Object.assign(t,gt(n)),{})}function gt(o){return{[`${o}Target`]:{get(){const e=this.targets.find(o);if(e)return e;throw new Error(`Missing target element "${o}" for "${this.identifier}" controller`)}},[`${o}Targets`]:{get(){return this.targets.findAll(o)}},[`has${L(o)}Target`]:{get(){return this.targets.has(o)}}}}function vt(o){const e=Ke(o,"values"),t={valueDescriptorMap:{get(){return e.reduce((n,s)=>{const c=he(s,this.identifier),h=this.data.getAttributeNameForKey(c.key);return Object.assign(n,{[h]:c})},{})}}};return e.reduce((n,s)=>Object.assign(n,yt(s)),t)}function yt(o,e){const t=he(o,e),{key:n,name:s,reader:c,writer:h}=t;return{[s]:{get(){const g=this.data.get(n);return g!==null?c(g):t.defaultValue},set(g){g===void 0?this.data.delete(n):this.data.set(n,h(g))}},[`has${L(s)}`]:{get(){return this.data.has(n)||t.hasCustomDefaultValue}}}}function he([o,e],t){return Ot({controller:t,token:o,typeDefinition:e})}function $(o){switch(o){case Array:return"array";case Boolean:return"boolean";case Number:return"number";case Object:return"object";case String:return"string"}}function I(o){switch(typeof o){case"boolean":return"boolean";case"number":return"number";case"string":return"string"}if(Array.isArray(o))return"array";if(Object.prototype.toString.call(o)==="[object Object]")return"object"}function bt(o){const{controller:e,token:t,typeObject:n}=o,s=Y(n.type),c=Y(n.default),h=s&&c,g=s&&!c,m=!s&&c,p=$(n.type),b=I(o.typeObject.default);if(g)return p;if(m)return b;if(p!==b){const r=e?`${e}.${t}`:t;throw new Error(`The specified default value for the Stimulus Value "${r}" must match the defined type "${p}". The provided default value of "${n.default}" is of type "${b}".`)}if(h)return p}function At(o){const{controller:e,token:t,typeDefinition:n}=o,c=bt({controller:e,token:t,typeObject:n}),h=I(n),g=$(n),m=c||h||g;if(m)return m;const p=e?`${e}.${n}`:t;throw new Error(`Unknown value type "${p}" for "${t}" value`)}function wt(o){const e=$(o);if(e)return te[e];const t=K(o,"default"),n=K(o,"type"),s=o;if(t)return s.default;if(n){const{type:c}=s,h=$(c);if(h)return te[h]}return o}function Ot(o){const{token:e,typeDefinition:t}=o,n=`${oe(e)}-value`,s=At(o);return{type:s,key:n,name:G(n),get defaultValue(){return wt(t)},get hasCustomDefaultValue(){return I(t)!==void 0},reader:Tt[s],writer:re[s]||re.default}}const te={get array(){return[]},boolean:!1,number:0,get object(){return{}},string:""},Tt={array(o){const e=JSON.parse(o);if(!Array.isArray(e))throw new TypeError(`expected value of type "array" but instead got value "${o}" of type "${I(e)}"`);return e},boolean(o){return!(o=="0"||String(o).toLowerCase()=="false")},number(o){return Number(o.replace(/_/g,""))},object(o){const e=JSON.parse(o);if(e===null||typeof e!="object"||Array.isArray(e))throw new TypeError(`expected value of type "object" but instead got value "${o}" of type "${I(e)}"`);return e},string(o){return o}},re={default:Et,array:ne,object:ne};function ne(o){return JSON.stringify(o)}function Et(o){return`${o}`}class M{constructor(e){this.context=e}static get shouldLoad(){return!0}static afterLoad(e,t){}get application(){return this.context.application}get scope(){return this.context.scope}get element(){return this.scope.element}get identifier(){return this.scope.identifier}get targets(){return this.scope.targets}get outlets(){return this.scope.outlets}get classes(){return this.scope.classes}get data(){return this.scope.data}initialize(){}connect(){}disconnect(){}dispatch(e,{target:t=this.element,detail:n={},prefix:s=this.identifier,bubbles:c=!0,cancelable:h=!0}={}){const g=s?`${s}:${e}`:e,m=new CustomEvent(g,{detail:n,bubbles:c,cancelable:h});return t.dispatchEvent(m),m}}M.blessings=[ft,_t,vt,pt];M.targets=[];M.outlets=[];M.values={};var N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},j={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var ie;function kt(){return ie||(ie=1,function(o){(function(){var e=function(){this.init()};e.prototype={init:function(){var r=this||t;return r._counter=1e3,r._html5AudioPool=[],r.html5PoolSize=10,r._codecs={},r._howls=[],r._muted=!1,r._volume=1,r._canPlayEvent="canplaythrough",r._navigator=typeof window<"u"&&window.navigator?window.navigator:null,r.masterGain=null,r.noAudio=!1,r.usingWebAudio=!0,r.autoSuspend=!0,r.ctx=null,r.autoUnlock=!0,r._setup(),r},volume:function(r){var i=this||t;if(r=parseFloat(r),i.ctx||b(),typeof r<"u"&&r>=0&&r<=1){if(i._volume=r,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(r,t.ctx.currentTime);for(var a=0;a<i._howls.length;a++)if(!i._howls[a]._webAudio)for(var l=i._howls[a]._getSoundIds(),d=0;d<l.length;d++){var f=i._howls[a]._soundById(l[d]);f&&f._node&&(f._node.volume=f._volume*r)}return i}return i._volume},mute:function(r){var i=this||t;i.ctx||b(),i._muted=r,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(r?0:i._volume,t.ctx.currentTime);for(var a=0;a<i._howls.length;a++)if(!i._howls[a]._webAudio)for(var l=i._howls[a]._getSoundIds(),d=0;d<l.length;d++){var f=i._howls[a]._soundById(l[d]);f&&f._node&&(f._node.muted=r?!0:f._muted)}return i},stop:function(){for(var r=this||t,i=0;i<r._howls.length;i++)r._howls[i].stop();return r},unload:function(){for(var r=this||t,i=r._howls.length-1;i>=0;i--)r._howls[i].unload();return r.usingWebAudio&&r.ctx&&typeof r.ctx.close<"u"&&(r.ctx.close(),r.ctx=null,b()),r},codecs:function(r){return(this||t)._codecs[r.replace(/^x-/,"")]},_setup:function(){var r=this||t;if(r.state=r.ctx&&r.ctx.state||"suspended",r._autoSuspend(),!r.usingWebAudio)if(typeof Audio<"u")try{var i=new Audio;typeof i.oncanplaythrough>"u"&&(r._canPlayEvent="canplay")}catch{r.noAudio=!0}else r.noAudio=!0;try{var i=new Audio;i.muted&&(r.noAudio=!0)}catch{}return r.noAudio||r._setupCodecs(),r},_setupCodecs:function(){var r=this||t,i=null;try{i=typeof Audio<"u"?new Audio:null}catch{return r}if(!i||typeof i.canPlayType!="function")return r;var a=i.canPlayType("audio/mpeg;").replace(/^no$/,""),l=r._navigator?r._navigator.userAgent:"",d=l.match(/OPR\/(\d+)/g),f=d&&parseInt(d[0].split("/")[1],10)<33,u=l.indexOf("Safari")!==-1&&l.indexOf("Chrome")===-1,_=l.match(/Version\/(.*?) /),v=u&&_&&parseInt(_[1],10)<15;return r._codecs={mp3:!!(!f&&(a||i.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!a,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(i.canPlayType('audio/wav; codecs="1"')||i.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!v&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!v&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},r},_unlockAudio:function(){var r=this||t;if(!(r._audioUnlocked||!r.ctx)){r._audioUnlocked=!1,r.autoUnlock=!1,!r._mobileUnloaded&&r.ctx.sampleRate!==44100&&(r._mobileUnloaded=!0,r.unload()),r._scratchBuffer=r.ctx.createBuffer(1,1,22050);var i=function(a){for(;r._html5AudioPool.length<r.html5PoolSize;)try{var l=new Audio;l._unlocked=!0,r._releaseHtml5Audio(l)}catch{r.noAudio=!0;break}for(var d=0;d<r._howls.length;d++)if(!r._howls[d]._webAudio)for(var f=r._howls[d]._getSoundIds(),u=0;u<f.length;u++){var _=r._howls[d]._soundById(f[u]);_&&_._node&&!_._node._unlocked&&(_._node._unlocked=!0,_._node.load())}r._autoResume();var v=r.ctx.createBufferSource();v.buffer=r._scratchBuffer,v.connect(r.ctx.destination),typeof v.start>"u"?v.noteOn(0):v.start(0),typeof r.ctx.resume=="function"&&r.ctx.resume(),v.onended=function(){v.disconnect(0),r._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0),document.removeEventListener("keydown",i,!0);for(var A=0;A<r._howls.length;A++)r._howls[A]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0),r}},_obtainHtml5Audio:function(){var r=this||t;if(r._html5AudioPool.length)return r._html5AudioPool.pop();var i=new Audio().play();return i&&typeof Promise<"u"&&(i instanceof Promise||typeof i.then=="function")&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(r){var i=this||t;return r._unlocked&&i._html5AudioPool.push(r),i},_autoSuspend:function(){var r=this;if(!(!r.autoSuspend||!r.ctx||typeof r.ctx.suspend>"u"||!t.usingWebAudio)){for(var i=0;i<r._howls.length;i++)if(r._howls[i]._webAudio){for(var a=0;a<r._howls[i]._sounds.length;a++)if(!r._howls[i]._sounds[a]._paused)return r}return r._suspendTimer&&clearTimeout(r._suspendTimer),r._suspendTimer=setTimeout(function(){if(r.autoSuspend){r._suspendTimer=null,r.state="suspending";var l=function(){r.state="suspended",r._resumeAfterSuspend&&(delete r._resumeAfterSuspend,r._autoResume())};r.ctx.suspend().then(l,l)}},3e4),r}},_autoResume:function(){var r=this;if(!(!r.ctx||typeof r.ctx.resume>"u"||!t.usingWebAudio))return r.state==="running"&&r.ctx.state!=="interrupted"&&r._suspendTimer?(clearTimeout(r._suspendTimer),r._suspendTimer=null):r.state==="suspended"||r.state==="running"&&r.ctx.state==="interrupted"?(r.ctx.resume().then(function(){r.state="running";for(var i=0;i<r._howls.length;i++)r._howls[i]._emit("resume")}),r._suspendTimer&&(clearTimeout(r._suspendTimer),r._suspendTimer=null)):r.state==="suspending"&&(r._resumeAfterSuspend=!0),r}};var t=new e,n=function(r){var i=this;if(!r.src||r.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}i.init(r)};n.prototype={init:function(r){var i=this;return t.ctx||b(),i._autoplay=r.autoplay||!1,i._format=typeof r.format!="string"?r.format:[r.format],i._html5=r.html5||!1,i._muted=r.mute||!1,i._loop=r.loop||!1,i._pool=r.pool||5,i._preload=typeof r.preload=="boolean"||r.preload==="metadata"?r.preload:!0,i._rate=r.rate||1,i._sprite=r.sprite||{},i._src=typeof r.src!="string"?r.src:[r.src],i._volume=r.volume!==void 0?r.volume:1,i._xhr={method:r.xhr&&r.xhr.method?r.xhr.method:"GET",headers:r.xhr&&r.xhr.headers?r.xhr.headers:null,withCredentials:r.xhr&&r.xhr.withCredentials?r.xhr.withCredentials:!1},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=r.onend?[{fn:r.onend}]:[],i._onfade=r.onfade?[{fn:r.onfade}]:[],i._onload=r.onload?[{fn:r.onload}]:[],i._onloaderror=r.onloaderror?[{fn:r.onloaderror}]:[],i._onplayerror=r.onplayerror?[{fn:r.onplayerror}]:[],i._onpause=r.onpause?[{fn:r.onpause}]:[],i._onplay=r.onplay?[{fn:r.onplay}]:[],i._onstop=r.onstop?[{fn:r.onstop}]:[],i._onmute=r.onmute?[{fn:r.onmute}]:[],i._onvolume=r.onvolume?[{fn:r.onvolume}]:[],i._onrate=r.onrate?[{fn:r.onrate}]:[],i._onseek=r.onseek?[{fn:r.onseek}]:[],i._onunlock=r.onunlock?[{fn:r.onunlock}]:[],i._onresume=[],i._webAudio=t.usingWebAudio&&!i._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i._preload!=="none"&&i.load(),i},load:function(){var r=this,i=null;if(t.noAudio){r._emit("loaderror",null,"No audio support.");return}typeof r._src=="string"&&(r._src=[r._src]);for(var a=0;a<r._src.length;a++){var l,d;if(r._format&&r._format[a])l=r._format[a];else{if(d=r._src[a],typeof d!="string"){r._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}l=/^data:audio\/([^;,]+);/i.exec(d),l||(l=/\.([^.]+)$/.exec(d.split("?",1)[0])),l&&(l=l[1].toLowerCase())}if(l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),l&&t.codecs(l)){i=r._src[a];break}}if(!i){r._emit("loaderror",null,"No codec support for selected audio sources.");return}return r._src=i,r._state="loading",window.location.protocol==="https:"&&i.slice(0,5)==="http:"&&(r._html5=!0,r._webAudio=!1),new s(r),r._webAudio&&h(r),r},play:function(r,i){var a=this,l=null;if(typeof r=="number")l=r,r=null;else{if(typeof r=="string"&&a._state==="loaded"&&!a._sprite[r])return null;if(typeof r>"u"&&(r="__default",!a._playLock)){for(var d=0,f=0;f<a._sounds.length;f++)a._sounds[f]._paused&&!a._sounds[f]._ended&&(d++,l=a._sounds[f]._id);d===1?r=null:l=null}}var u=l?a._soundById(l):a._inactiveSound();if(!u)return null;if(l&&!r&&(r=u._sprite||"__default"),a._state!=="loaded"){u._sprite=r,u._ended=!1;var _=u._id;return a._queue.push({event:"play",action:function(){a.play(_)}}),_}if(l&&!u._paused)return i||a._loadQueue("play"),u._id;a._webAudio&&t._autoResume();var v=Math.max(0,u._seek>0?u._seek:a._sprite[r][0]/1e3),A=Math.max(0,(a._sprite[r][0]+a._sprite[r][1])/1e3-v),w=A*1e3/Math.abs(u._rate),O=a._sprite[r][0]/1e3,T=(a._sprite[r][0]+a._sprite[r][1])/1e3;u._sprite=r,u._ended=!1;var V=function(){u._paused=!1,u._seek=v,u._start=O,u._stop=T,u._loop=!!(u._loop||a._sprite[r][2])};if(v>=T){a._ended(u);return}var y=u._node;if(a._webAudio){var q=function(){a._playLock=!1,V(),a._refreshBuffer(u);var S=u._muted||a._muted?0:u._volume;y.gain.setValueAtTime(S,t.ctx.currentTime),u._playStart=t.ctx.currentTime,typeof y.bufferSource.start>"u"?u._loop?y.bufferSource.noteGrainOn(0,v,86400):y.bufferSource.noteGrainOn(0,v,A):u._loop?y.bufferSource.start(0,v,86400):y.bufferSource.start(0,v,A),w!==1/0&&(a._endTimers[u._id]=setTimeout(a._ended.bind(a,u),w)),i||setTimeout(function(){a._emit("play",u._id),a._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?q():(a._playLock=!0,a.once("resume",q),a._clearTimer(u._id))}else{var X=function(){y.currentTime=v,y.muted=u._muted||a._muted||t._muted||y.muted,y.volume=u._volume*t.volume(),y.playbackRate=u._rate;try{var S=y.play();if(S&&typeof Promise<"u"&&(S instanceof Promise||typeof S.then=="function")?(a._playLock=!0,V(),S.then(function(){a._playLock=!1,y._unlocked=!0,i?a._loadQueue():a._emit("play",u._id)}).catch(function(){a._playLock=!1,a._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),u._ended=!0,u._paused=!0})):i||(a._playLock=!1,V(),a._emit("play",u._id)),y.playbackRate=u._rate,y.paused){a._emit("playerror",u._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}r!=="__default"||u._loop?a._endTimers[u._id]=setTimeout(a._ended.bind(a,u),w):(a._endTimers[u._id]=function(){a._ended(u),y.removeEventListener("ended",a._endTimers[u._id],!1)},y.addEventListener("ended",a._endTimers[u._id],!1))}catch(_e){a._emit("playerror",u._id,_e)}};y.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(y.src=a._src,y.load());var me=window&&window.ejecta||!y.readyState&&t._navigator.isCocoonJS;if(y.readyState>=3||me)X();else{a._playLock=!0,a._state="loading";var W=function(){a._state="loaded",X(),y.removeEventListener(t._canPlayEvent,W,!1)};y.addEventListener(t._canPlayEvent,W,!1),a._clearTimer(u._id)}}return u._id},pause:function(r){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"pause",action:function(){i.pause(r)}}),i;for(var a=i._getSoundIds(r),l=0;l<a.length;l++){i._clearTimer(a[l]);var d=i._soundById(a[l]);if(d&&!d._paused&&(d._seek=i.seek(a[l]),d._rateSeek=0,d._paused=!0,i._stopFade(a[l]),d._node))if(i._webAudio){if(!d._node.bufferSource)continue;typeof d._node.bufferSource.stop>"u"?d._node.bufferSource.noteOff(0):d._node.bufferSource.stop(0),i._cleanBuffer(d._node)}else(!isNaN(d._node.duration)||d._node.duration===1/0)&&d._node.pause();arguments[1]||i._emit("pause",d?d._id:null)}return i},stop:function(r,i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"stop",action:function(){a.stop(r)}}),a;for(var l=a._getSoundIds(r),d=0;d<l.length;d++){a._clearTimer(l[d]);var f=a._soundById(l[d]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,a._stopFade(l[d]),f._node&&(a._webAudio?f._node.bufferSource&&(typeof f._node.bufferSource.stop>"u"?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),a._cleanBuffer(f._node)):(!isNaN(f._node.duration)||f._node.duration===1/0)&&(f._node.currentTime=f._start||0,f._node.pause(),f._node.duration===1/0&&a._clearSound(f._node))),i||a._emit("stop",f._id))}return a},mute:function(r,i){var a=this;if(a._state!=="loaded"||a._playLock)return a._queue.push({event:"mute",action:function(){a.mute(r,i)}}),a;if(typeof i>"u")if(typeof r=="boolean")a._muted=r;else return a._muted;for(var l=a._getSoundIds(i),d=0;d<l.length;d++){var f=a._soundById(l[d]);f&&(f._muted=r,f._interval&&a._stopFade(f._id),a._webAudio&&f._node?f._node.gain.setValueAtTime(r?0:f._volume,t.ctx.currentTime):f._node&&(f._node.muted=t._muted?!0:r),a._emit("mute",f._id))}return a},volume:function(){var r=this,i=arguments,a,l;if(i.length===0)return r._volume;if(i.length===1||i.length===2&&typeof i[1]>"u"){var d=r._getSoundIds(),f=d.indexOf(i[0]);f>=0?l=parseInt(i[0],10):a=parseFloat(i[0])}else i.length>=2&&(a=parseFloat(i[0]),l=parseInt(i[1],10));var u;if(typeof a<"u"&&a>=0&&a<=1){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"volume",action:function(){r.volume.apply(r,i)}}),r;typeof l>"u"&&(r._volume=a),l=r._getSoundIds(l);for(var _=0;_<l.length;_++)u=r._soundById(l[_]),u&&(u._volume=a,i[2]||r._stopFade(l[_]),r._webAudio&&u._node&&!u._muted?u._node.gain.setValueAtTime(a,t.ctx.currentTime):u._node&&!u._muted&&(u._node.volume=a*t.volume()),r._emit("volume",u._id))}else return u=l?r._soundById(l):r._sounds[0],u?u._volume:0;return r},fade:function(r,i,a,l){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"fade",action:function(){d.fade(r,i,a,l)}}),d;r=Math.min(Math.max(0,parseFloat(r)),1),i=Math.min(Math.max(0,parseFloat(i)),1),a=parseFloat(a),d.volume(r,l);for(var f=d._getSoundIds(l),u=0;u<f.length;u++){var _=d._soundById(f[u]);if(_){if(l||d._stopFade(f[u]),d._webAudio&&!_._muted){var v=t.ctx.currentTime,A=v+a/1e3;_._volume=r,_._node.gain.setValueAtTime(r,v),_._node.gain.linearRampToValueAtTime(i,A)}d._startFadeInterval(_,r,i,a,f[u],typeof l>"u")}}return d},_startFadeInterval:function(r,i,a,l,d,f){var u=this,_=i,v=a-i,A=Math.abs(v/.01),w=Math.max(4,A>0?l/A:l),O=Date.now();r._fadeTo=a,r._interval=setInterval(function(){var T=(Date.now()-O)/l;O=Date.now(),_+=v*T,_=Math.round(_*100)/100,v<0?_=Math.max(a,_):_=Math.min(a,_),u._webAudio?r._volume=_:u.volume(_,r._id,!0),f&&(u._volume=_),(a<i&&_<=a||a>i&&_>=a)&&(clearInterval(r._interval),r._interval=null,r._fadeTo=null,u.volume(a,r._id),u._emit("fade",r._id))},w)},_stopFade:function(r){var i=this,a=i._soundById(r);return a&&a._interval&&(i._webAudio&&a._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(a._interval),a._interval=null,i.volume(a._fadeTo,r),a._fadeTo=null,i._emit("fade",r)),i},loop:function(){var r=this,i=arguments,a,l,d;if(i.length===0)return r._loop;if(i.length===1)if(typeof i[0]=="boolean")a=i[0],r._loop=a;else return d=r._soundById(parseInt(i[0],10)),d?d._loop:!1;else i.length===2&&(a=i[0],l=parseInt(i[1],10));for(var f=r._getSoundIds(l),u=0;u<f.length;u++)d=r._soundById(f[u]),d&&(d._loop=a,r._webAudio&&d._node&&d._node.bufferSource&&(d._node.bufferSource.loop=a,a&&(d._node.bufferSource.loopStart=d._start||0,d._node.bufferSource.loopEnd=d._stop,r.playing(f[u])&&(r.pause(f[u],!0),r.play(f[u],!0)))));return r},rate:function(){var r=this,i=arguments,a,l;if(i.length===0)l=r._sounds[0]._id;else if(i.length===1){var d=r._getSoundIds(),f=d.indexOf(i[0]);f>=0?l=parseInt(i[0],10):a=parseFloat(i[0])}else i.length===2&&(a=parseFloat(i[0]),l=parseInt(i[1],10));var u;if(typeof a=="number"){if(r._state!=="loaded"||r._playLock)return r._queue.push({event:"rate",action:function(){r.rate.apply(r,i)}}),r;typeof l>"u"&&(r._rate=a),l=r._getSoundIds(l);for(var _=0;_<l.length;_++)if(u=r._soundById(l[_]),u){r.playing(l[_])&&(u._rateSeek=r.seek(l[_]),u._playStart=r._webAudio?t.ctx.currentTime:u._playStart),u._rate=a,r._webAudio&&u._node&&u._node.bufferSource?u._node.bufferSource.playbackRate.setValueAtTime(a,t.ctx.currentTime):u._node&&(u._node.playbackRate=a);var v=r.seek(l[_]),A=(r._sprite[u._sprite][0]+r._sprite[u._sprite][1])/1e3-v,w=A*1e3/Math.abs(u._rate);(r._endTimers[l[_]]||!u._paused)&&(r._clearTimer(l[_]),r._endTimers[l[_]]=setTimeout(r._ended.bind(r,u),w)),r._emit("rate",u._id)}}else return u=r._soundById(l),u?u._rate:r._rate;return r},seek:function(){var r=this,i=arguments,a,l;if(i.length===0)r._sounds.length&&(l=r._sounds[0]._id);else if(i.length===1){var d=r._getSoundIds(),f=d.indexOf(i[0]);f>=0?l=parseInt(i[0],10):r._sounds.length&&(l=r._sounds[0]._id,a=parseFloat(i[0]))}else i.length===2&&(a=parseFloat(i[0]),l=parseInt(i[1],10));if(typeof l>"u")return 0;if(typeof a=="number"&&(r._state!=="loaded"||r._playLock))return r._queue.push({event:"seek",action:function(){r.seek.apply(r,i)}}),r;var u=r._soundById(l);if(u)if(typeof a=="number"&&a>=0){var _=r.playing(l);_&&r.pause(l,!0),u._seek=a,u._ended=!1,r._clearTimer(l),!r._webAudio&&u._node&&!isNaN(u._node.duration)&&(u._node.currentTime=a);var v=function(){_&&r.play(l,!0),r._emit("seek",l)};if(_&&!r._webAudio){var A=function(){r._playLock?setTimeout(A,0):v()};setTimeout(A,0)}else v()}else if(r._webAudio){var w=r.playing(l)?t.ctx.currentTime-u._playStart:0,O=u._rateSeek?u._rateSeek-u._seek:0;return u._seek+(O+w*Math.abs(u._rate))}else return u._node.currentTime;return r},playing:function(r){var i=this;if(typeof r=="number"){var a=i._soundById(r);return a?!a._paused:!1}for(var l=0;l<i._sounds.length;l++)if(!i._sounds[l]._paused)return!0;return!1},duration:function(r){var i=this,a=i._duration,l=i._soundById(r);return l&&(a=i._sprite[l._sprite][1]/1e3),a},state:function(){return this._state},unload:function(){for(var r=this,i=r._sounds,a=0;a<i.length;a++)i[a]._paused||r.stop(i[a]._id),r._webAudio||(r._clearSound(i[a]._node),i[a]._node.removeEventListener("error",i[a]._errorFn,!1),i[a]._node.removeEventListener(t._canPlayEvent,i[a]._loadFn,!1),i[a]._node.removeEventListener("ended",i[a]._endFn,!1),t._releaseHtml5Audio(i[a]._node)),delete i[a]._node,r._clearTimer(i[a]._id);var l=t._howls.indexOf(r);l>=0&&t._howls.splice(l,1);var d=!0;for(a=0;a<t._howls.length;a++)if(t._howls[a]._src===r._src||r._src.indexOf(t._howls[a]._src)>=0){d=!1;break}return d&&delete c[r._src],t.noAudio=!1,r._state="unloaded",r._sounds=[],r=null,null},on:function(r,i,a,l){var d=this,f=d["_on"+r];return typeof i=="function"&&f.push(l?{id:a,fn:i,once:l}:{id:a,fn:i}),d},off:function(r,i,a){var l=this,d=l["_on"+r],f=0;if(typeof i=="number"&&(a=i,i=null),i||a)for(f=0;f<d.length;f++){var u=a===d[f].id;if(i===d[f].fn&&u||!i&&u){d.splice(f,1);break}}else if(r)l["_on"+r]=[];else{var _=Object.keys(l);for(f=0;f<_.length;f++)_[f].indexOf("_on")===0&&Array.isArray(l[_[f]])&&(l[_[f]]=[])}return l},once:function(r,i,a){var l=this;return l.on(r,i,a,1),l},_emit:function(r,i,a){for(var l=this,d=l["_on"+r],f=d.length-1;f>=0;f--)(!d[f].id||d[f].id===i||r==="load")&&(setTimeout(function(u){u.call(this,i,a)}.bind(l,d[f].fn),0),d[f].once&&l.off(r,d[f].fn,d[f].id));return l._loadQueue(r),l},_loadQueue:function(r){var i=this;if(i._queue.length>0){var a=i._queue[0];a.event===r&&(i._queue.shift(),i._loadQueue()),r||a.action()}return i},_ended:function(r){var i=this,a=r._sprite;if(!i._webAudio&&r._node&&!r._node.paused&&!r._node.ended&&r._node.currentTime<r._stop)return setTimeout(i._ended.bind(i,r),100),i;var l=!!(r._loop||i._sprite[a][2]);if(i._emit("end",r._id),!i._webAudio&&l&&i.stop(r._id,!0).play(r._id),i._webAudio&&l){i._emit("play",r._id),r._seek=r._start||0,r._rateSeek=0,r._playStart=t.ctx.currentTime;var d=(r._stop-r._start)*1e3/Math.abs(r._rate);i._endTimers[r._id]=setTimeout(i._ended.bind(i,r),d)}return i._webAudio&&!l&&(r._paused=!0,r._ended=!0,r._seek=r._start||0,r._rateSeek=0,i._clearTimer(r._id),i._cleanBuffer(r._node),t._autoSuspend()),!i._webAudio&&!l&&i.stop(r._id,!0),i},_clearTimer:function(r){var i=this;if(i._endTimers[r]){if(typeof i._endTimers[r]!="function")clearTimeout(i._endTimers[r]);else{var a=i._soundById(r);a&&a._node&&a._node.removeEventListener("ended",i._endTimers[r],!1)}delete i._endTimers[r]}return i},_soundById:function(r){for(var i=this,a=0;a<i._sounds.length;a++)if(r===i._sounds[a]._id)return i._sounds[a];return null},_inactiveSound:function(){var r=this;r._drain();for(var i=0;i<r._sounds.length;i++)if(r._sounds[i]._ended)return r._sounds[i].reset();return new s(r)},_drain:function(){var r=this,i=r._pool,a=0,l=0;if(!(r._sounds.length<i)){for(l=0;l<r._sounds.length;l++)r._sounds[l]._ended&&a++;for(l=r._sounds.length-1;l>=0;l--){if(a<=i)return;r._sounds[l]._ended&&(r._webAudio&&r._sounds[l]._node&&r._sounds[l]._node.disconnect(0),r._sounds.splice(l,1),a--)}}},_getSoundIds:function(r){var i=this;if(typeof r>"u"){for(var a=[],l=0;l<i._sounds.length;l++)a.push(i._sounds[l]._id);return a}else return[r]},_refreshBuffer:function(r){var i=this;return r._node.bufferSource=t.ctx.createBufferSource(),r._node.bufferSource.buffer=c[i._src],r._panner?r._node.bufferSource.connect(r._panner):r._node.bufferSource.connect(r._node),r._node.bufferSource.loop=r._loop,r._loop&&(r._node.bufferSource.loopStart=r._start||0,r._node.bufferSource.loopEnd=r._stop||0),r._node.bufferSource.playbackRate.setValueAtTime(r._rate,t.ctx.currentTime),i},_cleanBuffer:function(r){var i=this,a=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!r.bufferSource)return i;if(t._scratchBuffer&&r.bufferSource&&(r.bufferSource.onended=null,r.bufferSource.disconnect(0),a))try{r.bufferSource.buffer=t._scratchBuffer}catch{}return r.bufferSource=null,i},_clearSound:function(r){var i=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);i||(r.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(r){this._parent=r,this.init()};s.prototype={init:function(){var r=this,i=r._parent;return r._muted=i._muted,r._loop=i._loop,r._volume=i._volume,r._rate=i._rate,r._seek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++t._counter,i._sounds.push(r),r.create(),r},create:function(){var r=this,i=r._parent,a=t._muted||r._muted||r._parent._muted?0:r._volume;return i._webAudio?(r._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),r._node.gain.setValueAtTime(a,t.ctx.currentTime),r._node.paused=!0,r._node.connect(t.masterGain)):t.noAudio||(r._node=t._obtainHtml5Audio(),r._errorFn=r._errorListener.bind(r),r._node.addEventListener("error",r._errorFn,!1),r._loadFn=r._loadListener.bind(r),r._node.addEventListener(t._canPlayEvent,r._loadFn,!1),r._endFn=r._endListener.bind(r),r._node.addEventListener("ended",r._endFn,!1),r._node.src=i._src,r._node.preload=i._preload===!0?"auto":i._preload,r._node.volume=a*t.volume(),r._node.load()),r},reset:function(){var r=this,i=r._parent;return r._muted=i._muted,r._loop=i._loop,r._volume=i._volume,r._rate=i._rate,r._seek=0,r._rateSeek=0,r._paused=!0,r._ended=!0,r._sprite="__default",r._id=++t._counter,r},_errorListener:function(){var r=this;r._parent._emit("loaderror",r._id,r._node.error?r._node.error.code:0),r._node.removeEventListener("error",r._errorFn,!1)},_loadListener:function(){var r=this,i=r._parent;i._duration=Math.ceil(r._node.duration*10)/10,Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue()),r._node.removeEventListener(t._canPlayEvent,r._loadFn,!1)},_endListener:function(){var r=this,i=r._parent;i._duration===1/0&&(i._duration=Math.ceil(r._node.duration*10)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=i._duration*1e3),i._ended(r)),r._node.removeEventListener("ended",r._endFn,!1)}};var c={},h=function(r){var i=r._src;if(c[i]){r._duration=c[i].duration,p(r);return}if(/^data:[^;]+;base64,/.test(i)){for(var a=atob(i.split(",")[1]),l=new Uint8Array(a.length),d=0;d<a.length;++d)l[d]=a.charCodeAt(d);m(l.buffer,r)}else{var f=new XMLHttpRequest;f.open(r._xhr.method,i,!0),f.withCredentials=r._xhr.withCredentials,f.responseType="arraybuffer",r._xhr.headers&&Object.keys(r._xhr.headers).forEach(function(u){f.setRequestHeader(u,r._xhr.headers[u])}),f.onload=function(){var u=(f.status+"")[0];if(u!=="0"&&u!=="2"&&u!=="3"){r._emit("loaderror",null,"Failed loading audio file with status: "+f.status+".");return}m(f.response,r)},f.onerror=function(){r._webAudio&&(r._html5=!0,r._webAudio=!1,r._sounds=[],delete c[i],r.load())},g(f)}},g=function(r){try{r.send()}catch{r.onerror()}},m=function(r,i){var a=function(){i._emit("loaderror",null,"Decoding audio data failed.")},l=function(d){d&&i._sounds.length>0?(c[i._src]=d,p(i,d)):a()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(r).then(l).catch(a):t.ctx.decodeAudioData(r,l,a)},p=function(r,i){i&&!r._duration&&(r._duration=i.duration),Object.keys(r._sprite).length===0&&(r._sprite={__default:[0,r._duration*1e3]}),r._state!=="loaded"&&(r._state="loaded",r._emit("load"),r._loadQueue())},b=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var r=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),i=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a=i?parseInt(i[1],10):null;if(r&&a&&a<9){var l=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!l&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};o.Howler=t,o.Howl=n,typeof N<"u"?(N.HowlerGlobal=e,N.Howler=t,N.Howl=n,N.Sound=s):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=n,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var n=this;if(!n.ctx||!n.ctx.listener)return n;for(var s=n._howls.length-1;s>=0;s--)n._howls[s].stereo(t);return n},HowlerGlobal.prototype.pos=function(t,n,s){var c=this;if(!c.ctx||!c.ctx.listener)return c;if(n=typeof n!="number"?c._pos[1]:n,s=typeof s!="number"?c._pos[2]:s,typeof t=="number")c._pos=[t,n,s],typeof c.ctx.listener.positionX<"u"?(c.ctx.listener.positionX.setTargetAtTime(c._pos[0],Howler.ctx.currentTime,.1),c.ctx.listener.positionY.setTargetAtTime(c._pos[1],Howler.ctx.currentTime,.1),c.ctx.listener.positionZ.setTargetAtTime(c._pos[2],Howler.ctx.currentTime,.1)):c.ctx.listener.setPosition(c._pos[0],c._pos[1],c._pos[2]);else return c._pos;return c},HowlerGlobal.prototype.orientation=function(t,n,s,c,h,g){var m=this;if(!m.ctx||!m.ctx.listener)return m;var p=m._orientation;if(n=typeof n!="number"?p[1]:n,s=typeof s!="number"?p[2]:s,c=typeof c!="number"?p[3]:c,h=typeof h!="number"?p[4]:h,g=typeof g!="number"?p[5]:g,typeof t=="number")m._orientation=[t,n,s,c,h,g],typeof m.ctx.listener.forwardX<"u"?(m.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),m.ctx.listener.forwardY.setTargetAtTime(n,Howler.ctx.currentTime,.1),m.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),m.ctx.listener.upX.setTargetAtTime(c,Howler.ctx.currentTime,.1),m.ctx.listener.upY.setTargetAtTime(h,Howler.ctx.currentTime,.1),m.ctx.listener.upZ.setTargetAtTime(g,Howler.ctx.currentTime,.1)):m.ctx.listener.setOrientation(t,n,s,c,h,g);else return p;return m},Howl.prototype.init=function(t){return function(n){var s=this;return s._orientation=n.orientation||[1,0,0],s._stereo=n.stereo||null,s._pos=n.pos||null,s._pannerAttr={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:360,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:360,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:0,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:"inverse",maxDistance:typeof n.maxDistance<"u"?n.maxDistance:1e4,panningModel:typeof n.panningModel<"u"?n.panningModel:"HRTF",refDistance:typeof n.refDistance<"u"?n.refDistance:1,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:1},s._onstereo=n.onstereo?[{fn:n.onstereo}]:[],s._onpos=n.onpos?[{fn:n.onpos}]:[],s._onorientation=n.onorientation?[{fn:n.onorientation}]:[],t.call(this,n)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,n){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(t,n)}}),s;var c=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof n>"u")if(typeof t=="number")s._stereo=t,s._pos=[t,0,0];else return s._stereo;for(var h=s._getSoundIds(n),g=0;g<h.length;g++){var m=s._soundById(h[g]);if(m)if(typeof t=="number")m._stereo=t,m._pos=[t,0,0],m._node&&(m._pannerAttr.panningModel="equalpower",(!m._panner||!m._panner.pan)&&e(m,c),c==="spatial"?typeof m._panner.positionX<"u"?(m._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),m._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),m._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):m._panner.setPosition(t,0,0):m._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),s._emit("stereo",m._id);else return m._stereo}return s},Howl.prototype.pos=function(t,n,s,c){var h=this;if(!h._webAudio)return h;if(h._state!=="loaded")return h._queue.push({event:"pos",action:function(){h.pos(t,n,s,c)}}),h;if(n=typeof n!="number"?0:n,s=typeof s!="number"?-.5:s,typeof c>"u")if(typeof t=="number")h._pos=[t,n,s];else return h._pos;for(var g=h._getSoundIds(c),m=0;m<g.length;m++){var p=h._soundById(g[m]);if(p)if(typeof t=="number")p._pos=[t,n,s],p._node&&((!p._panner||p._panner.pan)&&e(p,"spatial"),typeof p._panner.positionX<"u"?(p._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(n,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):p._panner.setPosition(t,n,s)),h._emit("pos",p._id);else return p._pos}return h},Howl.prototype.orientation=function(t,n,s,c){var h=this;if(!h._webAudio)return h;if(h._state!=="loaded")return h._queue.push({event:"orientation",action:function(){h.orientation(t,n,s,c)}}),h;if(n=typeof n!="number"?h._orientation[1]:n,s=typeof s!="number"?h._orientation[2]:s,typeof c>"u")if(typeof t=="number")h._orientation=[t,n,s];else return h._orientation;for(var g=h._getSoundIds(c),m=0;m<g.length;m++){var p=h._soundById(g[m]);if(p)if(typeof t=="number")p._orientation=[t,n,s],p._node&&(p._panner||(p._pos||(p._pos=h._pos||[0,0,-.5]),e(p,"spatial")),typeof p._panner.orientationX<"u"?(p._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),p._panner.orientationY.setValueAtTime(n,Howler.ctx.currentTime),p._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):p._panner.setOrientation(t,n,s)),h._emit("orientation",p._id);else return p._orientation}return h},Howl.prototype.pannerAttr=function(){var t=this,n=arguments,s,c,h;if(!t._webAudio)return t;if(n.length===0)return t._pannerAttr;if(n.length===1)if(typeof n[0]=="object")s=n[0],typeof c>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),t._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:t._panningModel});else return h=t._soundById(parseInt(n[0],10)),h?h._pannerAttr:t._pannerAttr;else n.length===2&&(s=n[0],c=parseInt(n[1],10));for(var g=t._getSoundIds(c),m=0;m<g.length;m++)if(h=t._soundById(g[m]),h){var p=h._pannerAttr;p={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:p.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:p.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:p.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:p.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:p.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:p.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:p.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:p.panningModel};var b=h._panner;b||(h._pos||(h._pos=t._pos||[0,0,-.5]),e(h,"spatial"),b=h._panner),b.coneInnerAngle=p.coneInnerAngle,b.coneOuterAngle=p.coneOuterAngle,b.coneOuterGain=p.coneOuterGain,b.distanceModel=p.distanceModel,b.maxDistance=p.maxDistance,b.refDistance=p.refDistance,b.rolloffFactor=p.rolloffFactor,b.panningModel=p.panningModel}return t},Sound.prototype.init=function(t){return function(){var n=this,s=n._parent;n._orientation=s._orientation,n._stereo=s._stereo,n._pos=s._pos,n._pannerAttr=s._pannerAttr,t.call(this),n._stereo?s.stereo(n._stereo):n._pos&&s.pos(n._pos[0],n._pos[1],n._pos[2],n._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var n=this,s=n._parent;return n._orientation=s._orientation,n._stereo=s._stereo,n._pos=s._pos,n._pannerAttr=s._pannerAttr,n._stereo?s.stereo(n._stereo):n._pos?s.pos(n._pos[0],n._pos[1],n._pos[2],n._id):n._panner&&(n._panner.disconnect(0),n._panner=void 0,s._refreshBuffer(n)),t.call(this)}}(Sound.prototype.reset);var e=function(t,n){n=n||"spatial",n==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()}(j)),j}var xt=kt();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var E=function(){return E=Object.assign||function(e){for(var t,n=1,s=arguments.length;n<s;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},E.apply(this,arguments)},Mt=function(){function o(e){this.options=e,this.listeners={}}return o.prototype.on=function(e,t){var n=this.listeners[e]||[];this.listeners[e]=n.concat([t])},o.prototype.triggerEvent=function(e,t){var n=this,s=this.listeners[e]||[];s.forEach(function(c){return c({target:n,event:t})})},o}(),F;(function(o){o[o.Add=0]="Add",o[o.Remove=1]="Remove"})(F||(F={}));var St=function(){function o(){this.notifications=[]}return o.prototype.push=function(e){this.notifications.push(e),this.updateFn(e,F.Add,this.notifications)},o.prototype.splice=function(e,t){var n=this.notifications.splice(e,t)[0];return this.updateFn(n,F.Remove,this.notifications),n},o.prototype.indexOf=function(e){return this.notifications.indexOf(e)},o.prototype.onUpdate=function(e){this.updateFn=e},o}(),k;(function(o){o.Dismiss="dismiss",o.Click="click"})(k||(k={}));var se={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},Ft=function(){function o(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var e=document.createDocumentFragment(),t=this._createHTMLElement({tagName:"div",className:"notyf"});e.appendChild(t),document.body.appendChild(e),this.container=t,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return o.prototype.on=function(e,t){var n;this.events=E(E({},this.events),(n={},n[e]=t,n))},o.prototype.update=function(e,t){t===F.Add?this.addNotification(e):t===F.Remove&&this.removeNotification(e)},o.prototype.removeNotification=function(e){var t=this,n=this._popRenderedNotification(e),s;if(n){s=n.node,s.classList.add("notyf__toast--disappear");var c;s.addEventListener(this.animationEndEventName,c=function(h){h.target===s&&(s.removeEventListener(t.animationEndEventName,c),t.container.removeChild(s))})}},o.prototype.addNotification=function(e){var t=this._renderNotification(e);this.notifications.push({notification:e,node:t}),this._announce(e.options.message||"Notification")},o.prototype._renderNotification=function(e){var t,n=this._buildNotificationCard(e),s=e.options.className;return s&&(t=n.classList).add.apply(t,s.split(" ")),this.container.appendChild(n),n},o.prototype._popRenderedNotification=function(e){for(var t=-1,n=0;n<this.notifications.length&&t<0;n++)this.notifications[n].notification===e&&(t=n);if(t!==-1)return this.notifications.splice(t,1)[0]},o.prototype.getXPosition=function(e){var t;return((t=e?.position)===null||t===void 0?void 0:t.x)||"right"},o.prototype.getYPosition=function(e){var t;return((t=e?.position)===null||t===void 0?void 0:t.y)||"bottom"},o.prototype.adjustContainerAlignment=function(e){var t=this.X_POSITION_FLEX_MAP[this.getXPosition(e)],n=this.Y_POSITION_FLEX_MAP[this.getYPosition(e)],s=this.container.style;s.setProperty("justify-content",n),s.setProperty("align-items",t)},o.prototype._buildNotificationCard=function(e){var t=this,n=e.options,s=n.icon;this.adjustContainerAlignment(n);var c=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),h=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),g=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),m=this._createHTMLElement({tagName:"div",className:"notyf__message"});m.innerHTML=n.message||"";var p=n.background||n.backgroundColor;if(s){var b=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if((typeof s=="string"||s instanceof String)&&(b.innerHTML=new String(s).valueOf()),typeof s=="object"){var r=s.tagName,i=r===void 0?"i":r,a=s.className,l=s.text,d=s.color,f=d===void 0?p:d,u=this._createHTMLElement({tagName:i,className:a,text:l});f&&(u.style.color=f),b.appendChild(u)}g.appendChild(b)}if(g.appendChild(m),c.appendChild(g),p&&(n.ripple?(h.style.background=p,c.appendChild(h)):c.style.background=p),n.dismissible){var _=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),v=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});_.appendChild(v),g.appendChild(_),c.classList.add("notyf__toast--dismissible"),v.addEventListener("click",function(w){var O,T;(T=(O=t.events)[k.Dismiss])===null||T===void 0||T.call(O,{target:e,event:w}),w.stopPropagation()})}c.addEventListener("click",function(w){var O,T;return(T=(O=t.events)[k.Click])===null||T===void 0?void 0:T.call(O,{target:e,event:w})});var A=this.getYPosition(n)==="top"?"upper":"lower";return c.classList.add("notyf__toast--"+A),c},o.prototype._createHTMLElement=function(e){var t=e.tagName,n=e.className,s=e.text,c=document.createElement(t);return n&&(c.className=n),c.textContent=s||null,c},o.prototype._createA11yContainer=function(){var e=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});e.setAttribute("aria-atomic","true"),e.setAttribute("aria-live","polite"),e.style.border="0",e.style.clip="rect(0 0 0 0)",e.style.height="1px",e.style.margin="-1px",e.style.overflow="hidden",e.style.padding="0",e.style.position="absolute",e.style.width="1px",e.style.outline="0",document.body.appendChild(e),this.a11yContainer=e},o.prototype._announce=function(e){var t=this;this.a11yContainer.textContent="",setTimeout(function(){t.a11yContainer.textContent=e},100)},o.prototype._getAnimationEndEventName=function(){var e=document.createElement("_fake"),t={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"},n;for(n in t)if(e.style[n]!==void 0)return t[n];return"animationend"},o}(),Nt=function(){function o(e){var t=this;this.dismiss=this._removeNotification,this.notifications=new St,this.view=new Ft;var n=this.registerTypes(e);this.options=E(E({},se),e),this.options.types=n,this.notifications.onUpdate(function(s,c){return t.view.update(s,c)}),this.view.on(k.Dismiss,function(s){var c=s.target,h=s.event;t._removeNotification(c),c.triggerEvent(k.Dismiss,h)}),this.view.on(k.Click,function(s){var c=s.target,h=s.event;return c.triggerEvent(k.Click,h)})}return o.prototype.error=function(e){var t=this.normalizeOptions("error",e);return this.open(t)},o.prototype.success=function(e){var t=this.normalizeOptions("success",e);return this.open(t)},o.prototype.open=function(e){var t=this.options.types.find(function(c){var h=c.type;return h===e.type})||{},n=E(E({},t),e);this.assignProps(["ripple","position","dismissible"],n);var s=new Mt(n);return this._pushNotification(s),s},o.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},o.prototype.assignProps=function(e,t){var n=this;e.forEach(function(s){t[s]=t[s]==null?n.options[s]:t[s]})},o.prototype._pushNotification=function(e){var t=this;this.notifications.push(e);var n=e.options.duration!==void 0?e.options.duration:this.options.duration;n&&setTimeout(function(){return t._removeNotification(e)},n)},o.prototype._removeNotification=function(e){var t=this.notifications.indexOf(e);t!==-1&&this.notifications.splice(t,1)},o.prototype.normalizeOptions=function(e,t){var n={type:e};return typeof t=="string"?n.message=t:typeof t=="object"&&(n=E(E({},n),t)),n},o.prototype.registerTypes=function(e){var t=(e&&e.types||[]).slice(),n=se.types.map(function(s){var c=-1;t.forEach(function(g,m){g.type===s.type&&(c=m)});var h=c!==-1?t.splice(c,1)[0]:{};return E(E({},s),h)});return n.concat(t)},o}();let D;const C=()=>D||(D=new Nt({ripple:!1,dismissible:!0,duration:2e3,types:[{type:"success",background:"black"}]}),D),pe=async o=>{try{if(navigator.clipboard)await navigator.clipboard.writeText(o);else{const e=document.createElement("textarea");e.value=o,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}C().success("Link copied to clipboard!")}catch(e){C().error(e.message)}};class Ct extends M{static values={id:String,universalLink:String,audio:String};static targets=["icon","audioProgress"];async connect(){this.soundPlayer=new xt.Howl({src:[this.audioValue],html5:!0,volume:.7}),this.soundPlayer.on("end",()=>{this.resetProgressBar(),this.updateAudioPreviewIcon(!0)}),this.soundPlayer.on("play",()=>{this.startAudioProgress()}),this.soundPlayer.on("pause",()=>{this.stopProgressUpdate()})}async share(){const e=this.universalLinkValue;if(!e){console.error("Universal link not found");return}try{if(navigator.share){await navigator.share({title:"idonthavespotify",text:"Listen now on your preferred streaming platform",url:e});return}await pe(e)}catch(t){console.error(t)}}toggleAudio(){const e=this.soundPlayer.playing();e?this.soundPlayer.pause():this.soundPlayer.play(),this.updateAudioPreviewIcon(e)}startAudioProgress(){this.audioProgressTarget.parentNode.classList.remove("hidden"),this.audioProgressInterval=setInterval(()=>{const e=this.soundPlayer.duration(),n=this.soundPlayer.seek()/e*100;this.audioProgressTarget.style.width=`${n}%`},10)}stopProgressUpdate(){clearInterval(this.audioProgressInterval)}resetProgressBar(){clearInterval(this.audioProgressInterval),this.audioProgressTarget.style.width="0%",this.audioProgressTarget.parentNode.classList.add("hidden")}updateAudioPreviewIcon(e){e?(this.iconTarget.classList.remove("ti-player-pause-filled"),this.iconTarget.classList.add("ti-player-play-filled")):(this.iconTarget.classList.remove("ti-player-play-filled"),this.iconTarget.classList.add("ti-player-pause-filled"))}}const It=Object.freeze(Object.defineProperty({__proto__:null,default:Ct},Symbol.toStringTag,{value:"Module"})),Lt=/^https:\/\/(open\.spotify\.com\/(?:intl-[a-z]{2}\/)?(track|album|playlist|artist|episode|show)|spotify\.link)\/(\w{11,24})(?:[\?#].*)?$/,Bt=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be|music\.youtube\.com)\/(?:watch\?v=|embed\/|v\/|shorts\/|playlist\?list=|channel\/)?([^&\s]{11,})/;class Pt extends M{static targets=["form","link"];initialize(){document.addEventListener("htmx:afterSwap",()=>{const e=new URLSearchParams(window.location.search),t=this.element.querySelector('[data-controller="search-card"]')?.getAttribute("data-search-card-id-value");t&&(e.set("id",t),window.history.replaceState({},"",`${window.location.pathname}?${e}`))}),document.addEventListener("htmx:error",function(){C().error("Something went wrong, please try again later.")})}async submitFromClipboard(){if("clipboard"in navigator){const e=new URLSearchParams(window.location.search);try{(await navigator.clipboard.readText()).match(new RegExp(`${Lt.source}|${Bt.source}`))&&!e.get("id")&&(this.linkTarget.value=link,this.formTarget.submit())}catch{C().error("Clipboard access error")}}else C().error("Feature not supported in your browser")}}const Dt=Object.freeze(Object.defineProperty({__proto__:null,default:Pt},Symbol.toStringTag,{value:"Module"}));class $t extends M{static values={url:String};share(){pe(this.urlValue)}}const Vt=Object.freeze(Object.defineProperty({__proto__:null,default:$t},Symbol.toStringTag,{value:"Module"}));var jt=/^(?:.*?(?:controllers|components)\/|\.?\.\/)?(.+)(?:[/_-]controller\..+?)$/;function Ht(o,e){o.load(Kt(e))}function Kt(o){return Object.entries(o).map(Rt).filter(e=>e)}function Rt([o,e]){var t;const n=Gt(o),s=(t=e.default)!=null?t:e;if(n&&typeof s=="function")return{identifier:n,controllerConstructor:s}}function Gt(o){const e=(o.match(jt)||[])[1];if(e)return e.replace(/_/g,"-").replace(/\//g,"--")}const Ut=ut.start(),qt=Object.assign({"./search_card_controller.js":It,"./search_controller.js":Dt,"./search_link_controller.js":Vt});Ht(Ut,qt);
