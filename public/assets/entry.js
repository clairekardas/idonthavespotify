const a=/^https:\/\/(open\.spotify\.com\/(track|album|playlist|artist|episode|show)|spotify\.link)\/(\w{11,24})(?:[\?#].*)?$/,r=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be|music\.youtube\.com)\/(?:watch\?v=|embed\/|v\/|shorts\/|playlist\?list=|channel\/)?([\w-]{11,})(?:\S+)?(?:&si=\S+)?/,e=new URLSearchParams(window.location.search),n=({link:t})=>{const o=document.getElementById("search-form");o.querySelector("input").value=t,htmx.ajax("POST","/search",{source:"#search-form"})},c=async()=>{if("clipboard"in navigator)try{const t=await navigator.clipboard.readText();t.match(new RegExp(`${a.source}|${r.source}`))&&!e.get("id")&&n({link:t})}catch(t){console.error("Clipboard access error:",t)}else console.error("Clipboard API is not supported.")};document.addEventListener("htmx:afterOnLoad",()=>{const t=document.getElementById("search-card")?.getAttribute("data-id");t&&(e.set("id",t),window.history.replaceState({},"",`${window.location.pathname}?${e}`))});document.addEventListener("htmx:timeout",function(){document.getElementById("search-results").innerHTML='<p class="mt-8 text-center">Something went wrong, try again later.</p>'});document.addEventListener("DOMContentLoaded",async()=>{await c()});
